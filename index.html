<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ingredient Calculator</title>
    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f3f4f6; /* Light gray background */
        }
        /* Initially hide the app content until password is entered */
        #app-content { display: none; }
    </style>
</head>
<body class="flex items-center justify-center min-h-screen p-4">
    <div id="app-content" class="bg-white p-8 rounded-xl shadow-lg w-full max-w-md">
        <h1 class="text-3xl font-bold text-center text-gray-800 mb-6">Recipe Ingredient Calculator</h1>

        <!-- Input for X (Total Weight) and Unit Selector -->
        <div class="mb-5">
            <label for="totalWeight" class="block text-gray-700 text-sm font-semibold mb-2">
                Enter Total Weight (X):
            </label>
            <div class="flex items-center space-x-2">
                <input
                    type="number"
                    id="totalWeight"
                    class="shadow-sm appearance-none border rounded-lg w-full py-3 px-4 text-gray-700 leading-tight focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition duration-200 ease-in-out"
                    placeholder="e.g., 1.0 (for 1 kg) or 500 (for 500 g)"
                    min="0"
                    step="0.01"
                >
                <div class="relative">
                    <select
                        id="weightUnit"
                        class="block appearance-none bg-white border border-gray-300 text-gray-700 py-3 px-4 pr-8 rounded-lg shadow-sm leading-tight focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition duration-200 ease-in-out"
                    >
                        <option value="kg">Kilograms (kg)</option>
                        <option value="g">Grams (g)</option>
                    </select>
                    <div class="pointer-events-none absolute inset-y-0 right-0 flex items-center px-2 text-gray-700">
                        <svg class="fill-current h-4 w-4" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20"><path d="M9.293 12.95l.707.707L15.657 8l-1.414-1.414L10 10.828 5.757 6.586 4.343 8z"/></svg>
                    </div>
                </div>
            </div>
        </div>

        <!-- Dropdown for Recipe Type -->
        <div class="mb-6">
            <label for="recipeType" class="block text-gray-700 text-sm font-semibold mb-2">
                Select Recipe Type:
            </label>
            <div class="relative">
                <select
                    id="recipeType"
                    class="block appearance-none w-full bg-white border border-gray-300 text-gray-700 py-3 px-4 pr-8 rounded-lg shadow-sm leading-tight focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition duration-200 ease-in-out"
                >
                    <option value="">-- Select --</option>
                    <option value="chickenThigh">Chicken Thigh</option>
                    <option value="chickenWing">Chicken Wing</option>
                    <option value="chickenBreast">Chicken Breast</option>
                    <option value="porkBelly">Pork Belly</option>
                    <option value="porkNeck">Pork Neck</option>
                    <option value="eggBrine">Egg Brine</option>
                </select>
                <div class="pointer-events-none absolute inset-y-0 right-0 flex items-center px-2 text-gray-700">
                    <svg class="fill-current h-4 w-4" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20"><path d="M9.293 12.95l.707.707L15.657 8l-1.414-1.414L10 10.828 5.757 6.586 4.343 8z"/></svg>
                </div>
            </div>
        </div>

        <!-- Button to Calculate -->
        <button
            id="calculateBtn"
            class="w-full bg-blue-600 hover:bg-blue-700 text-white font-bold py-3 px-4 rounded-lg focus:outline-none focus:shadow-outline transition duration-200 ease-in-out shadow-md hover:shadow-lg transform hover:scale-105"
        >
            Calculate Ingredients
        </button>

        <!-- Results Display Area -->
        <div id="results" class="mt-8 p-4 bg-gray-50 border border-gray-200 rounded-lg hidden">
            <h2 class="text-xl font-semibold text-gray-800 mb-3">Calculated Ingredients:</h2>
            <ul id="ingredientList" class="list-disc list-inside text-gray-700">
                <!-- Results will be dynamically inserted here -->
            </ul>
        </div>

        <!-- Message Box for Alerts -->
        <div id="messageBox" class="fixed inset-0 bg-gray-900 bg-opacity-75 flex items-center justify-center p-4 z-50 hidden">
            <div class="bg-white p-6 rounded-lg shadow-xl w-full max-w-sm">
                <h3 id="messageTitle" class="text-xl font-semibold text-gray-800 mb-4"></h3>
                <p id="messageContent" class="text-gray-700 mb-6"></p>
                <button id="closeMessage" class="w-full bg-blue-600 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded-lg focus:outline-none focus:shadow-outline">
                    OK
                </button>
            </div>
        </div>
    </div>

    <script>
// Password protection logic, runs immediately when the script loads
(function passwordProtect() {
    const allowedPasswords = ["zurukonnichiwa", "navikaK", "basekitchen789"];
    let entered = prompt("Enter the password to access this app:");
    if (allowedPasswords.includes(entered)) {
        document.getElementById('app-content').style.display = ''; // Make the app content visible
    } else {
        // Display access denied message using the custom message box
        document.getElementById('messageTitle').textContent = 'Access Denied';
        document.getElementById('messageContent').textContent = 'Incorrect password. Access denied. Redirecting...';
        document.getElementById('messageBox').classList.remove('hidden');
        // Redirect after the user clicks OK on the message box
        document.getElementById('closeMessage').addEventListener('click', () => {
            window.location.href = "https://www.google.com";
        }, { once: true }); // Ensure the event listener only triggers once
    }
})();

// Main application logic, runs after the DOM is fully loaded
document.addEventListener('DOMContentLoaded', function() {
    // Only proceed with app logic if the app-content is visible (i.e., password was correct)
    if (document.getElementById('app-content').style.display === 'none') {
        // If app-content is still hidden, it means the password was incorrect,
        // so the script should not attempt to set up event listeners or access elements
        // that are not yet visible or accessible.
        console.log('App content hidden due to password protection. Waiting for correct password.');
        return; // Exit the function if access is not granted
    }

    // Define recipes with ingredient percentages relative to the total weight
    const recipes = {
        "chickenThigh": { "Salt": 0.8, "Tasty salt": 0.2, "Mirin": 3, "ZZ Kikoman": 3, "Kombu": 0.5 },
        "chickenWing": { "Salt": 0.8, "Tasty salt": 0.2, "Mirin": 3, "ZZ Kikoman": 3, "Kombu": 0.5 },
        "chickenBreast": { "Salt": 0.8, "Tasty salt": 0.2, "Mirin": 3, "ZZ Kikoman": 3, "Kombu": 0.5 },
        "porkBelly": { "Tasty salt": 0.7, "Honey": 1.5, "Mirin": 3 },
        "porkNeck": { "Spicy shio koji": 4, "Tasty salt": 0.7, "Salt": 1, "Sugar": 1.5, "Kashmiri Chilli": 4, "Garlic powder": 2, "Mirin": 1.5 },
        "eggBrine": { "Salt": 1.3, "Sugar": 3, "ZZ Soy": 3, "Mirin": 3, "Kombu": 0.5 },
    };

    // Get references to all necessary DOM elements
    const totalWeightInput = document.getElementById('totalWeight');
    const weightUnitSelect = document.getElementById('weightUnit'); // Reference to the new unit dropdown
    const recipeTypeSelect = document.getElementById('recipeType');
    const calculateBtn = document.getElementById('calculateBtn');
    const resultsDiv = document.getElementById('results');
    const ingredientList = document.getElementById('ingredientList');
    const messageBox = document.getElementById('messageBox');
    const messageTitle = document.getElementById('messageTitle');
    const messageContent = document.getElementById('messageContent');
    const closeMessageBtn = document.getElementById('closeMessage');

    /**
     * Displays a custom message box with a title and content.
     * This replaces the browser's alert() for better UI and iframe compatibility.
     * @param {string} title - The title of the message.
     * @param {string} message - The content of the message.
     */
    function showMessageBox(title, message) {
        messageTitle.textContent = title;
        messageContent.textContent = message;
        messageBox.classList.remove('hidden'); // Show the message box
    }

    /**
     * Hides the custom message box.
     */
    function hideMessageBox() {
        messageBox.classList.add('hidden'); // Hide the message box
    }

    // Add event listener to the "OK" button in the message box to hide it
    closeMessageBtn.addEventListener('click', hideMessageBox);

    /**
     * Calculates the ingredients based on total weight and selected recipe type.
     * All calculations are performed in grams, and results are displayed in grams.
     */
    function calculateIngredients() {
        let totalWeight = parseFloat(totalWeightInput.value); // Get input weight
        const selectedUnit = weightUnitSelect.value; // Get selected unit ('kg' or 'g')
        const selectedRecipeType = recipeTypeSelect.value; // Get selected recipe type

        // Input validation
        if (isNaN(totalWeight) || totalWeight <= 0) {
            showMessageBox('Input Error', 'Please enter a valid positive number for Total Weight (X).');
            return; // Stop execution if validation fails
        }
        if (!selectedRecipeType) {
            showMessageBox('Input Error', 'Please select a Recipe Type.');
            return; // Stop execution if validation fails
        }

        // Convert totalWeight to grams if the input unit is kilograms
        if (selectedUnit === 'kg') {
            totalWeight *= 1000; // 1 kg = 1000 grams
        }
        // If selectedUnit is 'g', totalWeight is already in grams, so no conversion is needed

        const selectedRecipe = recipes[selectedRecipeType]; // Get the recipe object
        ingredientList.innerHTML = ''; // Clear any previously displayed ingredients
        resultsDiv.classList.add('hidden'); // Hide the results area until calculations are done

        if (selectedRecipe) {
            // Iterate over each ingredient in the selected recipe
            for (const ingredient in selectedRecipe) {
                // Ensure the property belongs to the recipe object and not its prototype chain
                if (selectedRecipe.hasOwnProperty(ingredient)) {
                    const percentage = selectedRecipe[ingredient]; // Get the percentage for the current ingredient
                    const grams = (percentage / 100) * totalWeight; // Calculate the amount in grams
                    const listItem = document.createElement('li'); // Create a new list item element
                    listItem.className = 'py-1 border-b border-gray-100 last:border-b-0'; // Apply Tailwind classes for styling
                    // Set the text content for the list item, showing ingredient, grams, and original percentage
                    listItem.textContent = `${ingredient}: ${grams.toFixed(2)} grams (${percentage}%)`;
                    ingredientList.appendChild(listItem); // Add the list item to the results list
                }
            }
            resultsDiv.classList.remove('hidden'); // Show the results area after calculations
        } else {
            // If the selected recipe type is not found in the 'recipes' object
            showMessageBox('Error', 'Selected recipe type not found. Please choose a valid recipe.');
        }
    }

    // Add event listener to the "Calculate Ingredients" button
    calculateBtn.addEventListener('click', calculateIngredients);
});
</script>
</body>
</html>
